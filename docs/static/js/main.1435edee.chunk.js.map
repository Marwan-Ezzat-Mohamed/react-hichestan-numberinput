{"version":3,"sources":["lib/NumberInput.js","Example.js","index.js"],"names":["NUMBER_FORMAT_FARSI","NUMBER_FORMAT_LATIN","lib_NumberInput","NumberInput","props","_this","Object","classCallCheck","this","possibleConstructorReturn","getPrototypeOf","call","readValuesFromProps","value","valueToShow","mapValue","numberFormat","selectionStart","undefined","selectionEnd","handleKeyDown","event","keyCode","preventDefault","updateState","deleteValue","target","updateValue","toString","ctrlKey","handlePaste","enteredValue","stripAnyThingButDigits","clipboardData","window","getData","handleInput","values","recheckValue","mapToFarsi","mapToLatin","newState","inputRef","current","document","activeElement","console","log","setSelectionRange","fireOnChange","element","enteredValueMapped","substring","length","qty","onChange","name","React","createRef","rr","nextProps","nextState","_this$props","rest","onInput","onPast","onKeyDown","pattern","inputMode","type","ref","objectWithoutProperties","react_default","a","createElement","assign","defaultValue","onPaste","Component","str","replace","e","String","fromCharCode","charCodeAt","Example","state","Number1","Number2","handleChange","t","setState","handleValueChange","substr","Fragment","style","width","placeholder","render","margin","src_Example","getElementById"],"mappings":"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","file":"static/js/main.1435edee.chunk.js","sourcesContent":["import React, { Component } from 'react';\n\nexport const NUMBER_FORMAT_FARSI = 'FARSI';\nexport const NUMBER_FORMAT_LATIN = 'LATIN';\n\nclass NumberInput extends Component {\n\n  constructor(props) {\n    super(props);\n    this.inputRef = React.createRef();\n\n    this.rr = 0;\n\n    this.values = this.readValuesFromProps(props);\n  }\n\n  readValuesFromProps = (props) => {\n    const value = props.value || '';\n    const valueToShow = this.mapValue(value, props.numberFormat);\n\n    return {\n      value,\n      valueToShow,\n      selectionStart: undefined,\n      selectionEnd: undefined,\n    };\n  };\n\n  handleKeyDown = (event) => {\n    // console.log('keyCode: ', event.keyCode, 'key: ', event.key);\n    if(event.keyCode===8) { //backspace\n      event.preventDefault();\n      this.updateState(this.deleteValue(event.target, -1));\n    }else if(event.keyCode===46){ //delete\n      event.preventDefault();\n      this.updateState(this.deleteValue(event.target, 1));\n    }else if(event.keyCode>=48 && event.keyCode<=57){ //digits\n      event.preventDefault();\n      // console.log('digit');\n      this.updateState(this.updateValue(event.target, (event.keyCode - 48).toString(), this.props.numberFormat));\n    }else if(event.keyCode>=36 && event.keyCode<=40){ //arrows\n    }else if(event.keyCode===9){ //tab\n    }else if(event.ctrlKey && (event.keyCode===67 || event.keyCode===86)){ //copy/paste\n    }else if(event.keyCode===229){ //android bug workaround\n    }else{\n      // console.log('other');\n      // console.log('keyCode: ', event.keyCode, 'key: ', event.key, 'ctrlKey: ', event.ctrlKey);\n      event.preventDefault();\n    }\n  };\n\n  handlePaste = (event) => {\n    event.preventDefault();\n\n    const enteredValue = stripAnyThingButDigits((event.clipboardData || window.clipboardData).getData('text'));\n\n    this.updateState(this.updateValue(event.target, enteredValue, this.props.numberFormat));\n  };\n\n  handleInput = (event) => {\n    if(this.values.valueToShow===event.target.value) return;\n\n    const enteredValue = stripAnyThingButDigits(event.target.value);\n\n    this.updateState(this.recheckValue(event.target, enteredValue, this.props.numberFormat));\n  };\n\n  mapValue = (value, numberFormat) => {\n    if(numberFormat===NUMBER_FORMAT_FARSI){\n      return mapToFarsi(value);\n    }else if(numberFormat===NUMBER_FORMAT_LATIN){\n      return mapToLatin(value);\n    }\n    return mapToFarsi(value);\n  };\n\n\n  updateState = (newState) => {\n    if(!newState) return;\n\n    this.values = newState;\n    this.inputRef.current.value = this.values.valueToShow;\n    if(this.inputRef.current===document.activeElement){\n      console.log('has focus :D');\n      this.inputRef.current.setSelectionRange(this.values.selectionStart, this.values.selectionEnd);\n    }else{\n      console.log('has not focus :(');\n    }\n    this.fireOnChange();\n  };\n\n  updateValue = (element, enteredValue, numberFormat) => {\n    const enteredValueMapped = this.mapValue(enteredValue, numberFormat);\n    let valueToShow = element.value;\n    let selectionStart = element.selectionStart;\n    let selectionEnd = element.selectionEnd;\n\n    valueToShow = valueToShow.substring(0, selectionStart) + enteredValueMapped + valueToShow.substring(selectionEnd);\n\n    selectionStart += enteredValueMapped.length;\n    selectionEnd = selectionStart;\n\n    const value = mapToLatin(valueToShow);\n\n    return {\n      value,\n      valueToShow,\n      selectionStart,\n      selectionEnd,\n    };\n  };\n\n  recheckValue = (element, enteredValue, numberFormat) => {\n    let valueToShow = this.mapValue(enteredValue, numberFormat);\n    let selectionStart = element.selectionStart;\n    let selectionEnd = element.selectionEnd;\n\n    const value = mapToLatin(valueToShow);\n\n    return {\n      value,\n      valueToShow,\n      selectionStart,\n      selectionEnd,\n    };\n  };\n\n  deleteValue = (element, qty) => {\n    let valueToShow = element.value;\n    let selectionStart = element.selectionStart;\n    let selectionEnd = element.selectionEnd;\n\n    // console.log({selectionStart, selectionEnd})\n\n    if(selectionStart===selectionEnd){\n      if(qty < 0) {\n        if(selectionStart===0) return;\n        valueToShow = valueToShow.substring(0, selectionStart + qty) + valueToShow.substring(selectionEnd);\n        selectionStart += qty;\n      }else{\n        if(selectionEnd===valueToShow.length) return;\n        valueToShow = valueToShow.substring(0, selectionStart) + valueToShow.substring(selectionEnd+qty);\n      }\n    }else{\n      valueToShow = valueToShow.substring(0, selectionStart) + valueToShow.substring(selectionEnd);\n    }\n\n    selectionEnd = selectionStart;\n\n    const value = mapToLatin(valueToShow);\n\n    return {\n      value,\n      valueToShow,\n      selectionStart,\n      selectionEnd,\n    };\n  };\n\n  fireOnChange = () => {\n    if(this.props.onChange){\n      this.props.onChange({target: {name: this.props.name, value: this.values.value}});\n    }\n  };\n\n  shouldComponentUpdate(nextProps, nextState){\n    if(nextProps.value !== this.values.value || nextProps.numberFormat !== this.props.numberFormat){\n      this.updateState(this.readValuesFromProps(nextProps));\n    }\n    return false;\n  }\n\n  render() {\n\n    this.rr += 1;\n    // console.log('rendered')\n\n    const {value, onChange, onInput, onPast, onKeyDown, pattern, inputMode, type, ref, numberFormat, ...rest} = this.props;\n    const {valueToShow} = this.values;\n\n    return (\n      <input\n        ref={this.inputRef}\n        type={\"text\"}\n        inputMode={\"numeric\"}\n        pattern={\"[0-9]*\"}\n        defaultValue={valueToShow}\n        onKeyDown={this.handleKeyDown}\n        onPaste={this.handlePaste}\n        onInput={this.handleInput}\n        {...rest}\n      />\n      );\n  }\n}\nexport default NumberInput;\n\n\nexport function mapToFarsi(str) {\n  if(!str) return str;\n  return str.toString().replace(/[1234567890]/gi, e => String.fromCharCode(e.charCodeAt(0) + 1728))\n}\n\nexport function mapToLatin(str) {\n  if(!str) return str;\n  return str.toString().replace(/[۱۲۳۴۵۶۷۸۹۰]/gi, e => String.fromCharCode(e.charCodeAt(0) - 1728))\n}\n\nexport function stripAnyThingButDigits(str) {\n  if(!str) return str;\n  return str.toString().replace(/[^1234567890۱۲۳۴۵۶۷۸۹۰]/gi, '');\n}\n","import React, { Component } from 'react';\nimport { NumberInput } from \"./lib\";\nimport {NUMBER_FORMAT_LATIN} from './lib/NumberInput';\n\nclass Example extends Component {\n  state = {\n    Number1: '',\n    Number2: '123',\n  };\n\n  handleChange = (event) => {\n    const newState = {};\n    const t = event.target;\n\n    newState[t.name] = t.value;\n    this.setState(newState, ()=>{\n      console.log('after', this.state)\n    });\n  };\n\n  handleValueChange = (event) => {\n    const newState = {};\n    const t = event.target;\n\n    newState[t.name.substr(0, 7)] = t.value;\n    this.setState(newState, ()=>{\n      console.log('after', this.state)\n    });\n  };\n\n  render(){\n    return (\n      <React.Fragment>\n        <div>\n          <br/>ورژن ۱\n          <br/>\n          <br/>\n          <label>خروجی عدد لاتین\n            <br/>\n            <input type=\"text\" name=\"Number1_value\" style={{width: 250}} value={this.state.Number1} onChange={this.handleValueChange}  placeholder=\"از اینجا کلید تب را چند بار بزنید\" />\n          </label>\n          <br/>\n          <br/>\n          <label>\n            نمونه فارسی\n            <br/>\n            <NumberInput name=\"Number1\" value={this.state.Number1} onChange={this.handleChange} placeholder=\"type/paste a number\" />\n          </label>\n        </div>\n        <br/>\n        <div>\n          <label>\n            نمونه لاتین\n            <br/>\n            <NumberInput name=\"Number2\" value={this.state.Number2} numberFormat={NUMBER_FORMAT_LATIN} onChange={this.handleChange} placeholder=\"type/paste a number\" />\n          </label>\n        </div>\n        <br/>\n        <br/>\n        <label>خروجی\n          <br/>\n          <input type=\"text\" name=\"Number2_value\" style={{width: 250}} value={this.state.Number2} onChange={this.handleValueChange} placeholder=\"این فیلد خروجی است\" />\n        </label>\n      </React.Fragment>\n    );\n  }\n}\n\nexport default Example;\n","import React from 'react';\nimport { render } from \"react-dom\";\nimport Example from './Example';\n\nconst App = () => (\n  <div style={{ width: 640, margin: \"15px auto\" }}>\n    <h1>Hello React</h1>\n\n    <Example/>\n\n  </div>\n);\n\nrender(<App />, document.getElementById(\"root\"));\n"],"sourceRoot":""}